---
layout: post
title: 实验吧web
date: 2018-8-13
categories: blog
tags: [实验吧web解法]
description: 文艺的流氓。
---
<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307474 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1637"/>
<h1>实验吧题目学习</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2018/8/8 21:50</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2018/8/11 9:03</i></td></tr>
<tr><td><b>作者：</b></td><td><i>1809070261@qq.com</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div><ul><li><div>今天在学习shiyanba的第三题的时候，涉及到了php弱类型。自我是不懂的，所以来学习一下Php的弱类型是什么。</div></li><li><div>PHP中有两种比较的符号 ==与===。一个是相等，一个是全等。</div></li><li><div>=== 在进行比较的时候，会先判断两种字符串的类型是否相等，在比较。那么意思就是说如果数据类型不相等的话，也就是不会比较值。</div></li><li><div>== 在进行比较的时候，会先将字符串类型转化相同，在比较。</div></li></ul><div><div><img src="实验吧题目学习_files/Image.png" type="image/png" data-filename="Image.png"/><img src="实验吧题目学习_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><ul><li><div>也就是说==在比较的时候，a会转化成整形来和b比较。那么此时比较的值，如果字符串中是纯数字。那么就可以比较。如果是字符那么会等于0</div></li></ul><div><img src="实验吧题目学习_files/Image [2].png" type="image/png" data-filename="Image.png"/><img src="实验吧题目学习_files/Image [3].png" type="image/png" data-filename="Image.png"/></div></div><ul><li><div>那么是字符串1admin会等于1，而admin1不等于1.还有就是0e123123==0e456456是相等的,0e是科学计数法的数字，无论0的多少次方都是等于0</div></li><li><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">当一个字符串被当作一个数值来取值，其结果和类型如下:如果该字符串没有包含'.','e','E'并且其数值值在整形的范围之内</span></div></li><li><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">该字符串被当作int来取值，其他所有情况下都被作为float来取值，该字符串的开始部分决定了它的值，如果该字符串以合法的数值开始，则使用该数值，否则其值为0。</span></div></li><li><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">意思就是说：字符串1aaa当作是整形的话，那么会取开始的值，也就是说1aaa会取1.</span></div></li><li><div>这样的话就是就是解释了'admin1'==1 会是false</div></li></ul><div><ul><li><div>再来看个利用0e绕过判断的。</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">isset</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'Username'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]) &amp;&amp;</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">isset</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])) {</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$logined</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">true</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$Username</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'Username'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">];</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$password</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">];</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(!</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ctype_alpha</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$Username</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)) {</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$logined</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">false</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(!</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">is_numeric</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$password</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) ) {</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$logined</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">false</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">md5</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$Username</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) !=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">md5</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$password</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)) {</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$logined</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">false</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$logined</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;successful&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;login failed!&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//只要其中$username的md5值要和$password相等。</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//并且username是需要字符串的</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//而password时候需要整形的</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//所以说只要是字符串加密之后是0e开头和数字加密后是0e开头的，就可以成功的绕过。</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">QNKCDZO</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">0e830400451993494058024219903391</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">s878926199a</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">0e545993274517709034328855841020</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">s155964671a</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">0e342768416822451524974117254469</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">s214587387a</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">0e848240448830537924465865611904</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">s214587387a</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">0e848240448830537924465865611904</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">s878926199a</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">0e545993274517709034328855841020</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">s1091221200a</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">0e940624217856561557816327384675</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  </span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">s1885207154a</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">0e509367213418206700842008763514</span></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//这些都是加密之后0e开头的字符串和数字。</span></div></div><ul><li><div><span style="font-weight: bold;">Josn绕过，这个的绕过其实也是利用'admin'=0,的弱类型</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;?php</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">if (isset($_POST['message'])) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    $message = json_decode($_POST['message']);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    $key =&quot;*********&quot;;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    if ($message-&gt;key == $key) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        echo &quot;flag&quot;;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    else {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        echo &quot;fail&quot;;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">else{</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">     echo &quot;~~~~&quot;;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">?&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//传入{&quot;key&quot;:0} 那么就是可以绕过的。key的值是0  这里传入的是Json的格式,然后通过解码就是成了0</span></div></div><ul><li><div><span style="font-weight: bold;">这是一个绕过数组判断和遍历的方法。</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(!</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">is_array</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'test'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])){</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">exit</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">();}</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//一定是要传入一个数组，不然会直接退出</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$test</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'test'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">];</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">for</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">count</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$test</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">++){</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//count是返回数组中的元素的数目</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$test</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]===</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;admin&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//数组中的值不能和admin相等</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;error&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">exit</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">();</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$test</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]=</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">intval</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$test</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]);</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//把数组中的值转化为为INT类型</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">array_search</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;admin&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$test</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)===</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//搜索数组中的值返回键名，而且键名必须是等于0</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;flag&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;false&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//payload就是test[]=0</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//经过自己的实验，当数组没有传入任何值的时候，这时候的下标就是0.</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//所以就这样绕过了。代码是很矛盾的了，上面不能够有admin，而下面的话搜索值返回键0.</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//官方文档说如果给出的值没有指定键名，则取当前最大整数索引值，如果当前没有整数索引，则键名将是0</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$a</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">array</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">var_dump</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">array_search</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;admin&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$a</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">));</span></div><div><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">var_dump</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">array_search</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;1admin&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$a</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">));</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//第一行是返回的值是int(0)</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//第二行是放回的值是int(1)</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//因为我这里定义的是INT，而上面的是一个STR，但是被转化成了INT类型,</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//其实array_search函数，就是类似于== </span></div></div><ul><li><div><span style="font-weight: bold;">strcmp漏洞绕过 php -v &lt;5.3</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$a</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'asdsadasdasd'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">isset</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'a'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])){</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strcmp</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'a'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">],</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$a</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)==</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;1&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;2&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//传入一个数组就可以，因为函数接受了不符合的类型，会发生错误，但是还是返回0。就是相等</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">// <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">如果 str1 小于 str2 返回 &lt; 0； 如果 str1 大于 str2 返回 &gt; 0；如果两者相等，返回 0。</span></span></div></div></div><ul><li><div><span style="font-weight: bold;">switch绕过</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$a</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;2admin&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">switch</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$a</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) {</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">case</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">:</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;fail1&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">break</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">case</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">2</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">:</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;good&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">break</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//其实和前面的原理是相同的，$a == 1 。那么会取开头，也就是弱类型。</span></div></div><ul><li><div><span style="background-color: rgb(255, 250, 165); font-weight: bold;-evernote-highlight:true;">第一题</span><span style="font-weight: bold;">，第一个要求就是不能出现./   第二个要求就是不能出现\\   第三个要求对字符进行了限制大小写。第四个要求就是不能再Url中出现//  第五个要求就是要以web1.php结尾 第六个要求就是不能出p.   第七个要求url不能和/shiyan/web1.php一样。  所有此时的payload应该是 web1.php.因为要求必须是要web1.php结尾。然后就可以拿到flag</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&lt;?php</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">// code by SEC@USTC</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;charset&quot; content=&quot;gbk&quot;&gt;&lt;/head&gt;&lt;body&gt;'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$URL</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_SERVER</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'REQUEST_URI'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">];</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">// echo 'URL: '.$URL.'&lt;br/&gt;';</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;CTF{this_is_flag}&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$code</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">str_replace</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'CTF{???}'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">file_get_contents</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'./web1.php'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">));</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//这道题目本身也有教学的目的</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//第一，我们可以构造 /indirection/a/../ /indirection/./ 等等这一类的</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//所以，第一个要求就是不得出现 ./</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&amp;&amp;</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strpos</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$URL</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'./'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) !==</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">FALSE</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//Pass</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//第二，我们可以构造 \ 来代替被过滤的 /</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//所以，第二个要求就是不得出现 ../</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&amp;&amp;</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strpos</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$URL</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">\\</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) !==</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">FALSE</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">2</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//Pass</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//第三，有的系统大小写通用，例如 indirectioN/</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//你也可以用?和#等等的字符绕过，这需要统一解决</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//所以，第三个要求对可以用的字符做了限制，a-z / 和 .</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$matches</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">array</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">();</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">preg_match</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'/^([a-z0-9\/.]+)$/'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$URL</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$matches</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">// print_r($matches);</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&amp;&amp;</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">empty</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$matches</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) ||</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$matches</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">] !=</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$URL</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">3</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//Pass</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//第四，多个 / 也是可以的</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//所以，第四个要求是不得出现 //</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&amp;&amp;</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strpos</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$URL</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'//'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) !==</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">FALSE</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">4</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//Pass</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//第五，显然加上index.php或者减去index.php都是可以的</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//所以我们下一个要求就是必须包含/index.php，并且以此结尾</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&amp;&amp;</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">substr</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$URL</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">, -</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">9</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) !==</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'/web1.php'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">5</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//Not Pass</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//第六，我们知道在index.php后面加.也是可以的</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//所以我们禁止p后面出现.这个符号</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&amp;&amp;</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strpos</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$URL</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'p.'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) !==</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">FALSE</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">6</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//Not Pass</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//第七，现在是最关键的时刻</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//你的$URL必须与/indirection/index.php有所不同</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&amp;&amp;</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$URL</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">==</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'/shiyanba/web1.php'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">7</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//Not Pass</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(!</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">8</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'Flag: '</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&lt;/br&gt;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'Stop: '</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'&lt;hr /&gt;'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">for</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$stop</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">++)</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$code</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">str_replace</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'//Pass '</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'//Pass'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$code</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">for</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(;</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">8</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">++)</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$code</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">str_replace</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'//Pass '</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$i</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'//Not Pass'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$code</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">highlight_string</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$code</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">TRUE</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'&lt;/body&gt;&lt;/html&gt;'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div></div><ul><li><div><span style="background-color: rgb(255, 250, 165); font-weight: bold;-evernote-highlight:true;">第二题</span><span style="font-weight: bold;">，当中存在extract这个函数，作用就是把数组中的键变成了一个变量。还有就是一个file_get_contents是把文件读入一个字符串中，那么这样的话就是变量覆盖。</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&lt;?php</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$filename</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="color: #660e7a; background-color: #f7faff; font-weight: bold; font-style: italic; font-family: Monaco; font-size: 9pt;">__FILE__</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;{this_is_flag}&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">extract</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">isset</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$shiyan</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$content</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">trim</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">file_get_contents</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$filename</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">));</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$shiyan</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">==</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$content</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) {</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">; }</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'Oh.no'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;} }</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">?&gt;</span></div></div><ul><li><div><span style="font-weight: bold;">接下来是一道shiyanba的题目。WEB3</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$username</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;this_is_secret&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$password</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;this_is_not_known_to_you&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;{this_is_flag}&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$info</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">isset</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'info'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])?</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'info'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]:</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&quot;</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$data_unserialize</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">unserialize</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$info</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$data_unserialize</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'username'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]==</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$username</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&amp;&amp;</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$data_unserialize</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]==</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$password</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;username or password error!&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//这里unserialize是反序列化，而且下面是对比了username和password的值，</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//那么就是payload就是 <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">a:2:{s:8:&quot;username&quot;;i:0;s:8:&quot;password&quot;;i:0;}</span></span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//也是一个弱类型，就是说int和str比较。和上面的原理差不多。</span></span></div></div><ul><li><div><span style="font-weight: bold;">web4题就是一个正则匹配，只能是数字和字母，传入的值必须是大于9999999长度小于8位。并且匹配当中有没有*-*</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;{this_is_flag}&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">isset</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])) {</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ereg</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;^[a-zA-Z0-9]+$&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]) ===</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">FALSE</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'&lt;p&gt;You password must be alphanumeric&lt;/p&gt;'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strlen</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]) &lt;</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">8</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&amp;&amp;</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">] &gt;</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">9999999</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strpos</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">],</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'*-*'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) !==</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">FALSE</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">die</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'Flag: '</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'&lt;p&gt;*-* have not been found&lt;/p&gt;'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'&lt;p&gt;Invalid password&lt;/p&gt;'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//那么这样的话，可以使用科学计数法来。9e7就是99999999.就是说e7后面是跟了7个0.</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//ereg函数存在Null截断漏洞。就可以使用%00截断正则匹配</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//那么最够构造的payload就是9e7%00*-*</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//这道题目也就是考察了，一个00截断的方法。</span></div></div><ul><li><div><span style="font-weight: bold;">web5</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;{this_is_flag}&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">isset</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'a'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])) {</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strcmp</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'a'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">],</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) ==</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">die</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'Flag: '</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">print</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'离成功更近一步了'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//我的思路就是，strcmp是当变量类型不同的时候，虽然会是报错，但是flag还是会出来。主要是考察的strcmp</span></div></div><ul><li><div><span style="font-weight: bold;">web6</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">session_start</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">();</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;{this_is_flag}&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">isset</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])) {</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">] ==</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_SESSION</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">die</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'Flag: '</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">print</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'&lt;p&gt;Wrong guess.&lt;/p&gt;'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mt_srand</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">((</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">microtime</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">() ^</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">rand</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">10000</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)) %</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">rand</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">10000</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) +</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">rand</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">10000</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">));</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_SESSION</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">] =</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mt_rand</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">();</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//这道题目就是$_session没有定义引发的绕过</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//这是比较两个值是不是相等</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//看飞哥大佬的WP说burp抓包，把其中的phpsession删除掉。然后再传入一个空值就可以了。</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//还有一种就是用火狐浏览器中的cookie删除掉，然后再传入空值就可以了</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//因为session是随机生成的，上一次和下一次的是肯定不一样的。所以把session定义为空</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//原理就是判断session的password的值，那么是可以把这个赋值过程中的值删除的。</span></div></div><ul><li><div><span style="font-weight: bold;">Web7题目 这一道题目是sha1比较</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&lt;?php</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'{this_is_flag}'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">isset</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'name'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">and isset</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])) {</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sha1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'name'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]).</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&lt;/br&gt;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sha1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]).</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&lt;/br&gt;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'name'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">] ==</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'&lt;p&gt;Your password can not be your name!&lt;/p&gt;'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sha1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'name'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]) ==</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sha1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'password'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]))</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">die</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'Flag: '</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$flag</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'&lt;p&gt;Invalid password.&lt;/p&gt;'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'&lt;p&gt;Login first!&lt;/p&gt;'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">?&gt;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">//这道的题目其实和Md5的那道题目差不多，只要找两个sha1加密过后是0e开头的值就可以绕过的</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">//   <span style="font-weight: bold; font-family: Monaco; font-size: 9pt; color: rgb(0, 0, 128);">aaroZmOk   <span style="font-weight: bold; font-family: Monaco; font-size: 9pt; color: rgb(0, 0, 128);">aaK1STfY 加密过后就是0e开头</span></span></span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">//第二种方法就是使用数组绕过，sha1是不能加密数组的然后会返回错误，也是返回的是0.</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;"><span style="font-weight: bold; font-family: Monaco; font-size: 9pt; color: rgb(0, 0, 128);">//第二种的payload name[]=12312&amp;password[]=3232</span></span></div></div><ul><li><div><span style="font-weight: bold;">web8</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$miwen</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">function</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">encode(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$str</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_o</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strrev</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$str</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">// echo $_o;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">for</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strlen</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_o</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">++){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_c</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">substr</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_o</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$__</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ord</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_c</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)+</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_c</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">chr</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$__</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_c</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">return</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">str_rot13</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strrev</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">base64_encode</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)));</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//这道题目意思就是说把$miwen解密出来。</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$a</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">function</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">code(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$str</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$b</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">str_rot13</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$str</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$b</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strrev</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$b</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$b</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">base64_decode</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$b</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">for</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$sum</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">0</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$sum</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strlen</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$b</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$sum</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">++){</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$c</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">substr</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$b</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$sum</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$d</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">chr</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ord</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$c</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)-</span><span style="color: #0000ff; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">1</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">@</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$f</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$f</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$d</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">return</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">strrev</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$f</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">code(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$a</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//加密的那么我就是逆算出来，可以看到的时候上面显示反转一下，然后再通过for循环出来的值，再进行了加密。。</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//那么思路逆着来，从下往上面看。注意的是：最后的哪里是需要return返回出来的。</span></div></div><ul><li><div><span style="font-weight: bold;">Web10</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&lt;?php</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">eregi</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;hackerDJ&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'id'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">])) {</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">exit</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">();</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'id'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">] =</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">urldecode</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'id'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]);</span> <span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//解码url编码</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_GET</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'id'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">] ==</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;hackerDJ&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&lt;p&gt;flag: *****************} &lt;/p&gt;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">?&gt;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">br</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;&lt;</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">br</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Can you authenticate to this website?</span></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//这道题就是传入来的值是能够被解码一次然后还能够等于hackerDJ</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//那么意思就是说要把hackerDJ URL转码两次就可以了。</span></div></div><ul><li><div><span style="font-weight: bold;">Web11</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">html</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">head</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">welcome to simplexue</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;/</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">head</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">body</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&lt;?php</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_POST</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #660e7a; background-color: #f7faff; font-weight: bold; font-style: italic; font-family: Monaco; font-size: 9pt;">user</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">] &amp;&amp;</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_POST</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #660e7a; background-color: #f7faff; font-weight: bold; font-style: italic; font-family: Monaco; font-size: 9pt;">pass</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]) {</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$conn</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mysql_connect</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;*******&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;****&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;****&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mysql_select_db</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;****&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)</span> <span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">or die</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;Could not select database&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$conn</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">-&gt;</span><span style="color: #660e7a; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">connect_error</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) {</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">die</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;Connection failed: &quot;</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">.</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mysql_error</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$conn</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">));</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$user</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_POST</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #660e7a; background-color: #f7faff; font-weight: bold; font-style: italic; font-family: Monaco; font-size: 9pt;">user</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">];</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$pass</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">md5</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_POST</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #660e7a; background-color: #f7faff; font-weight: bold; font-style: italic; font-family: Monaco; font-size: 9pt;">pass</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]);</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$sql</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;select</span> <span style="color: #008000; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">user</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">from php where (</span><span style="color: #008000; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">user</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">='</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$user</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">') and (pw='</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$pass</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">')&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$query</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mysql_query</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$sql</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(!</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$query</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) {</span></div><div><span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">printf</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;Error: %s</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">\n</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mysql_error</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$conn</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">));</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">exit</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">();</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$row</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mysql_fetch_array</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$query</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">,</span> <span style="color: #660e7a; background-color: #f7faff; font-weight: bold; font-style: italic; font-family: Monaco; font-size: 9pt;">MYSQL_ASSOC</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="color: #808080; background-color: #f7faff; font-style: italic; font-family: Monaco; font-size: 9pt;">//echo $row[&quot;pw&quot;];</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$row</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'user'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]==</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;admin&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) {</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&lt;p&gt;Logged in! Key: *********** &lt;/p&gt;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$row</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">'user'</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">] !=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;admin&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) {</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;&lt;p&gt;You are not admin!&lt;/p&gt;&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">);</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">?&gt;</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">form</span> <span style="color: #0000ff; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">method=</span><span style="color: #008000; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">post</span> <span style="color: #0000ff; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">action=</span><span style="color: #008000; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">index.php</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">input</span> <span style="color: #0000ff; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">type=</span><span style="color: #008000; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">text</span> <span style="color: #0000ff; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">name=</span><span style="color: #008000; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">user</span> <span style="color: #0000ff; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">value=</span><span style="color: #008000; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;Username&quot;</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">input</span> <span style="color: #0000ff; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">type=</span><span style="color: #008000; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">password</span> <span style="color: #0000ff; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">name=</span><span style="color: #008000; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">pass</span> <span style="color: #0000ff; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">value=</span><span style="color: #008000; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;Password&quot;</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">input</span> <span style="color: #0000ff; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">type=</span><span style="color: #008000; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">submit</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;/</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">form</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;/</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">body</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">a</span> <span style="color: #0000ff; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">href=</span><span style="color: #008000; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;index.txt&quot;</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;/</span><span style="color: #000080; background-color: #efefef; font-weight: bold; font-family: Monaco; font-size: 9pt;">html</span><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&gt;</span></div><div><br/></div><div><span style="background-color: #efefef; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//分析了一下代码，代码的意思就是说要查询出数据库中的user字段要等于admin，那么我的思路就是把后面密码字段注释掉。而SQL查询语句就是把User的那么的括号给闭合掉。payload=user=admin') and 1 = 1 %23pass=1</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">//and 1 = 1返回的是真，所以说会返回一条记录。用or 1= 1就会返回多条记录</span></div></div><ul><li><div><span style="font-weight: bold;">Web12</span></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&lt;?php</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">function</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">GetIP(){</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(!</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">empty</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_SERVER</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;HTTP_CLIENT_IP&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]))</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$cip</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_SERVER</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;HTTP_CLIENT_IP&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">];</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(!</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">empty</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_SERVER</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;HTTP_X_FORWARDED_FOR&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]))</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$cip</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_SERVER</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;HTTP_X_FORWARDED_FOR&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">];</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else if</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(!</span><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">empty</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_SERVER</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;REMOTE_ADDR&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">]))</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$cip</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$_SERVER</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">[</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;REMOTE_ADDR&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">];</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$cip</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">=</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;0.0.0.0&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">return</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$cip</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$GetIPs</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">= GetIP();</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$GetIPs</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">if</span> <span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span><span style="color: #660000; background-color: #f7faff; font-family: Monaco; font-size: 9pt;">$GetIPs</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">==</span><span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;1.1.1.1&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">){</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;Great! Key is *********&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">else</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">echo</span> <span style="color: #008000; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">&quot;错误！你的IP不在访问列表之内！&quot;</span><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">;</span></div><div><span style="background-color: #f7faff; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">?&gt;</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">//代码的意思就是说，前面是判断了用了那种方法获取到的客户端的IP地址。如果没有的话会把IP给成0.0.0.0 那么就是没有地址</span></div><div><span style="color: #000080; background-color: #f7faff; font-weight: bold; font-family: Monaco; font-size: 9pt;">//可以使用burp来抓包，把其中的X-forwarded-For修改为1.1.1.1 然后就会输出flag.</span></div></div></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><br/></div><div><br/></div></span>
</div></body></html>